/** handorgel v0.4.2, @license MIT */
function t(t){return void 0===t}function e(e,s){const i=Object.getOwnPropertyDescriptor(e,s);return t(e[s])||i&&i.writable}function s(t){let s,i=arguments;for(let n=1;n<i.length;++n)if(s=i[n])for(let i in s)e(t,i)&&(t[i]=s[i]);return t}var i="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=function(t,e){return e={exports:{}},t(e,e.exports),e.exports}(function(t){!function(e,s){t.exports?t.exports=s():e.EvEmitter=s()}("undefined"!=typeof window?window:i,function(){"use strict";function t(){}var e=t.prototype;return e.on=function(t,e){if(t&&e){var s=this._events=this._events||{},i=s[t]=s[t]||[];return-1==i.indexOf(e)&&i.push(e),this}},e.once=function(t,e){if(t&&e){this.on(t,e);var s=this._onceEvents=this._onceEvents||{};return(s[t]=s[t]||{})[e]=!0,this}},e.off=function(t,e){var s=this._events&&this._events[t];if(s&&s.length){var i=s.indexOf(e);return-1!=i&&s.splice(i,1),this}},e.emitEvent=function(t,e){var s=this._events&&this._events[t];if(s&&s.length){s=s.slice(0),e=e||[];for(var i=this._onceEvents&&this._onceEvents[t],n=0;n<s.length;n++){var o=s[n];i&&i[o]&&(this.off(t,o),delete i[o]),o.apply(this,e)}return this}},e.allOff=function(){delete this._events,delete this._onceEvents},t})});let o=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame,a={};const h={button:{"aria-controls":function(){return this.id+"-content"},"aria-expanded":function(){return this.expanded?"true":"false"},"aria-disabled":function(){return this.disabled?"true":"false"}},content:{role:function(){return"region"},"aria-labelledby":function(){return this.id+"-header"}}},l={arrowDown:40,arrowUp:38,pageUp:33,pageDown:34,end:35,home:36};class r{constructor(t,e,s){e.handorgelFold||(this.handorgel=t,this.header=e,this.button=e.firstElementChild,this.content=s,this.header.handorgelFold=this,this.content.handorgelFold=this,a[this.handorgel.id]||(a[this.handorgel.id]=0),this.id=`${this.handorgel.id}-fold${++a[this.handorgel.id]}`,this.header.setAttribute("id",this.id+"-header"),this.content.setAttribute("id",this.id+"-content"),this.focused=!1,this.expanded=!1,this.disabled=!1,this._listeners={},this._bindEvents(),this._initAria(),this._initialOpen(),this._initialFocus())}open(t=!0){this.expanded||(this.handorgel.emitEvent("fold:open",[this]),this.expanded=!0,this.handorgel.options.collapsible||this.disable(),this._updateAria("button","aria-expanded"),this.header.classList.add(this.handorgel.options.headerOpenClass),this.content.classList.add(this.handorgel.options.contentOpenClass),this.resize(t),t||this._opened())}close(t=!0){this.expanded&&(this.handorgel.emitEvent("fold:close",[this]),this.expanded=!1,this.handorgel.options.collapsible||this.enable(),this._updateAria("button","aria-expanded"),this.header.classList.remove(this.handorgel.options.headerOpenedClass),this.content.classList.remove(this.handorgel.options.contentOpenedClass),this.resize(t),t||this._closed())}disable(){this.disabled=!0,this._updateAria("button","aria-disabled"),this.header.classList.add(this.handorgel.options.headerDisabledClass),this.content.classList.add(this.handorgel.options.contentDisabledClass)}enable(){this.disabled=!1,this._updateAria("button","aria-disabled"),this.header.classList.remove(this.handorgel.options.headerDisabledClass),this.content.classList.remove(this.handorgel.options.contentDisabledClass)}focus(){this.button.focus()}blur(){this.button.blur()}toggle(t=!0){this.expanded?this.close(t):this.open(t)}resize(t=!1){let e=0;t||(this.header.classList.add(this.handorgel.options.headerNoTransitionClass),this.content.classList.add(this.handorgel.options.contentNoTransitionClass)),this.expanded&&(e=this.content.firstElementChild.offsetHeight),this.content.style.height=e+"px",t||o(()=>{this.header.classList.remove(this.handorgel.options.headerNoTransitionClass),this.content.classList.remove(this.handorgel.options.contentNoTransitionClass)})}destroy(){this._unbindEvents(),this._cleanAria(),this.header.classList.remove(this.handorgel.options.headerOpenClass),this.header.classList.remove(this.handorgel.options.headerOpenedClass),this.header.classList.remove(this.handorgel.options.headerFocusClass),this.header.classList.remove(this.handorgel.options.headerNoTransitionClass),this.content.classList.remove(this.handorgel.options.contentOpenClass),this.content.classList.remove(this.handorgel.options.contentOpenedClass),this.content.classList.remove(this.handorgel.options.contentFocusClass),this.content.classList.remove(this.handorgel.options.contentNoTransitionClass),this.content.style.height="0px",this.header.handorgelFold=null,this.content.handorgelFold=null,this.header.removeAttribute("id"),this.content.removeAttribute("id"),this.handorgel=null}_opened(){this.header.classList.add(this.handorgel.options.headerOpenedClass),this.content.classList.add(this.handorgel.options.contentOpenedClass),this.handorgel.emitEvent("fold:opened",[this])}_closed(){this.header.classList.remove(this.handorgel.options.headerOpenClass),this.content.classList.remove(this.handorgel.options.contentOpenClass),this.handorgel.emitEvent("fold:closed",[this])}_initialOpen(){null===this.header.getAttribute(this.handorgel.options.initialOpenAttribute)&&null===this.content.getAttribute(this.handorgel.options.initialOpenAttribute)||(this.handorgel.options.initialOpenTransition?window.setTimeout(()=>{this.open()},this.handorgel.options.initialOpenTransitionDelay):this.open(!1))}_initialFocus(){null!==this.button.getAttribute("autofocus")&&this._handleFocus()}_initAria(){this._updateAria("button"),this._updateAria("content")}_cleanAria(){this._updateAria("button",null,!0),this._updateAria("content",null,!0)}_updateAria(t,e=null,s=!1){if(this.handorgel.options.ariaEnabled)if(e){const s=h[t][e].call(this);this[t].setAttribute(e,s)}else for(let e in h[t])if(h[t].hasOwnProperty(e))if(s)this[t].removeAttribute(e);else{const s=h[t][e].call(this);this[t].setAttribute(e,s)}}_handleContentTransitionEnd(t){t.target===t.currentTarget&&"height"===t.propertyName&&(this.handorgel.resize(!0),this.expanded?this._opened():this._closed())}_handleFocus(){this.focused=!0,this.header.classList.add(this.handorgel.options.headerFocusClass),this.content.classList.add(this.handorgel.options.contentFocusClass),this.handorgel.emitEvent("fold:focus",[this])}_handleBlur(){this.focused=!1,this.header.classList.remove(this.handorgel.options.headerFocusClass),this.content.classList.remove(this.handorgel.options.contentFocusClass),this.handorgel.emitEvent("fold:blur",[this])}_handleButtonClick(t){this.focus(),this.disabled||this.toggle()}_handleButtonKeydown(t){if(!this.handorgel.options.keyboardInteraction)return;let e=null;switch(t.which){case l.arrowDown:e="next";break;case l.arrowUp:e="prev";break;case l.home:e="first";break;case l.end:e="last";break;case l.pageDown:t.ctrlKey&&(e="next");break;case l.pageUp:t.ctrlKey&&(e="prev")}e&&(t.preventDefault(),this.handorgel.focus(e))}_handleContentKeydown(t){if(!this.handorgel.options.keyboardInteraction||!t.ctrlKey)return;let e=null;switch(t.which){case l.pageDown:e="next";break;case l.pageUp:e="prev"}e&&(t.preventDefault(),this.handorgel.focus(e))}_bindEvents(){this._listeners={bFocus:["focus",this.button,this._handleFocus.bind(this)],bBlur:["blur",this.button,this._handleBlur.bind(this)],bClick:["click",this.button,this._handleButtonClick.bind(this)],bKeydown:["keydown",this.button,this._handleButtonKeydown.bind(this)],cKeydown:["keydown",this.content,this._handleContentKeydown.bind(this)],cTransition:["transitionend",this.content,this._handleContentTransitionEnd.bind(this)]};for(let t in this._listeners)if(this._listeners.hasOwnProperty(t)){const e=this._listeners[t];e[1].addEventListener(e[0],e[2])}}_unbindEvents(){for(let t in this._listeners)if(this._listeners.hasOwnProperty(t)){const e=this._listeners[t];e[1].removeEventListener(e[0],e[2])}}}let d=0;class c extends n{constructor(t,e={}){super(),t.handorgel||(this.element=t,this.element.handorgel=this,this.id=`handorgel${++d}`,this.element.setAttribute("id",this.id),this.folds=[],this.options=s({},c.defaultOptions,e),this._listeners={},this._resizing=!1,this._bindEvents(),this._initAria(),this.update())}update(){this.folds=[];const t=this.element.children;for(let e=0,s=t.length;e<s;e+=2){const s=t[e],i=t[e+1];let n=s.handorgelFold;n||(n=new r(this,s,i)),this.folds.push(n)}}resize(t=!1){this.folds.forEach(e=>{e.resize(t)}),this._resizing=!1}focus(t){const e=this.folds.length;let s=null;for(let t=0;t<e&&null===s;t++)this.folds[t].focused&&(s=t);if("prev"!==t&&"next"!==t||null!==s||(t="prev"===t?"last":"first"),"prev"===t&&0===s){if(!this.options.carouselFocus)return;t="last"}if("next"===t&&s===e-1){if(!this.options.carouselFocus)return;t="first"}switch(t){case"prev":this.folds[--s].focus();break;case"next":this.folds[++s].focus();break;case"last":this.folds[e-1].focus();break;case"first":default:this.folds[0].focus()}}destroy(){this.emitEvent("destroy"),this.element.removeAttribute("id"),this.folds.forEach(t=>{t.destroy()}),this._unbindEvents(),this._cleanAria(),this.element.handorgel=null,this.emitEvent("destroyed")}_handleFoldOpen(t){this.options.multiSelectable||this.folds.forEach(e=>{t!==e&&e.close()})}_handleResize(){this._resizing||(this._resizing=!0,o(()=>{this.resize()}))}_initAria(){this.options.ariaEnabled&&(this.element.setAttribute("role","presentation"),this.options.multiSelectable&&this.element.setAttribute("aria-multiselectable","true"))}_cleanAria(){this.element.removeAttribute("role"),this.element.removeAttribute("aria-multiselectable")}_bindEvents(){this._listeners.resize=this._handleResize.bind(this),window.addEventListener("resize",this._listeners.resize),this._listeners.foldOpen=this._handleFoldOpen.bind(this),this.on("fold:open",this._listeners.foldOpen)}_unbindEvents(){window.removeEventListener("resize",this._listeners.resize),this.off("fold:open",this._listeners.foldOpen)}}c.defaultOptions={keyboardInteraction:!0,multiSelectable:!0,ariaEnabled:!0,collapsible:!0,carouselFocus:!0,initialOpenAttribute:"data-open",initialOpenTransition:!0,initialOpenTransitionDelay:200,headerOpenClass:"handorgel__header--open",contentOpenClass:"handorgel__content--open",headerOpenedClass:"handorgel__header--opened",contentOpenedClass:"handorgel__content--opened",headerDisabledClass:"handorgel__header--disabled",contentDisabledClass:"handorgel__content--disabled",headerFocusClass:"handorgel__header--focus",contentFocusClass:"handorgel__content--focus",headerNoTransitionClass:"handorgel__header--notransition",contentNoTransitionClass:"handorgel__content--notransition"};export default c;